exports.id=293,exports.ids=[293],exports.modules={8575:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>g});var s=r(997),n=r(6689),i=r(1664),o=r.n(i),l=r(1163),c=r(7179),d=r(8695),m=r(4080),h=r(97),u=r(5548),x=r(9514),p=r(1415),f=r(3407),y=e([c]);function g(){let[e,t]=(0,n.useState)(!1),{user:r,logout:a}=(0,c.a)(),i=(0,l.useRouter)(),y=async()=>{try{await a()}catch(e){console.error("Erreur lors de la d\xe9connexion:",e)}},g=[{name:"Accueil",href:"/"},{name:"\xc0 propos",href:"/about"},{name:"Contact",href:"/contact"}],j=[{name:"Mon profil",href:"/profile",icon:h.Z},{name:"Param\xe8tres",href:"/settings",icon:u.Z}];return s.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,s.jsxs)("nav",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Top",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between py-4",children:[s.jsx("div",{className:"flex items-center",children:(0,s.jsxs)(o(),{href:"/",className:"flex items-center",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"h-8 w-8 bg-primary-600 rounded-lg flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-lg",children:"C"})})}),(0,s.jsxs)("div",{className:"ml-3",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"CFRM"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Feedback communautaire"})]})]})}),s.jsx("div",{className:"hidden md:flex md:items-center md:space-x-8",children:g.map(e=>s.jsx(o(),{href:e.href,className:`text-sm font-medium transition-colors duration-200 ${i.pathname===e.href?"text-primary-600":"text-gray-700 hover:text-primary-600"}`,children:e.name},e.name))}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[r?(0,s.jsxs)(s.Fragment,{children:[s.jsx(o(),{href:"/dashboard",className:"btn-primary",children:"Tableau de bord"}),(0,s.jsxs)(d.v,{as:"div",className:"relative ml-3",children:[s.jsx("div",{children:(0,s.jsxs)(d.v.Button,{className:"flex max-w-xs items-center rounded-full bg-white text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[s.jsx("span",{className:"sr-only",children:"Ouvrir le menu utilisateur"}),s.jsx("div",{className:"h-8 w-8 rounded-full bg-primary-100 flex items-center justify-center",children:s.jsx("span",{className:"text-primary-600 font-medium text-sm",children:r.first_name?.[0]||r.username[0].toUpperCase()})})]})}),s.jsx(m.u,{as:n.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,s.jsxs)(d.v.Items,{className:"absolute right-0 z-10 mt-2 w-48 origin-top-right rounded-md bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[(0,s.jsxs)("div",{className:"px-4 py-2 border-b border-gray-200",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.full_name}),s.jsx("p",{className:"text-sm text-gray-500",children:r.organization?.name})]}),j.map(e=>s.jsx(d.v.Item,{children:({active:t})=>(0,s.jsxs)(o(),{href:e.href,className:`${t?"bg-gray-100":""} flex items-center px-4 py-2 text-sm text-gray-700`,children:[s.jsx(e.icon,{className:"mr-3 h-4 w-4"}),e.name]})},e.name)),s.jsx(d.v.Item,{children:({active:e})=>(0,s.jsxs)("button",{onClick:y,className:`${e?"bg-gray-100":""} flex w-full items-center px-4 py-2 text-sm text-gray-700`,children:[s.jsx(x.Z,{className:"mr-3 h-4 w-4"}),"D\xe9connexion"]})})]})})]})]}):(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[s.jsx(o(),{href:"/login",className:"text-sm font-medium text-gray-700 hover:text-primary-600",children:"Connexion"}),s.jsx(o(),{href:"/register",className:"btn-primary",children:"S'inscrire"})]}),s.jsx("div",{className:"md:hidden",children:(0,s.jsxs)("button",{type:"button",className:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",onClick:()=>t(!e),children:[s.jsx("span",{className:"sr-only",children:"Ouvrir le menu principal"}),e?s.jsx(p.Z,{className:"block h-6 w-6","aria-hidden":"true"}):s.jsx(f.Z,{className:"block h-6 w-6","aria-hidden":"true"})]})})]})]}),e&&s.jsx("div",{className:"md:hidden",children:s.jsx("div",{className:"space-y-1 pb-3 pt-2",children:g.map(e=>s.jsx(o(),{href:e.href,className:`block px-3 py-2 text-base font-medium ${i.pathname===e.href?"bg-primary-50 border-primary-500 text-primary-700":"border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-800"}`,onClick:()=>t(!1),children:e.name},e.name))})})]})})}c=(y.then?(await y)():y)[0],a()}catch(e){a(e)}})},7179:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{H:()=>c,a:()=>d});var s=r(997),n=r(6689),i=r(1163),o=r(4030),l=e([o]);o=(l.then?(await l)():l)[0];let m=(0,n.createContext)(void 0);function c({children:e}){let[t,r]=(0,n.useState)(null),[a,l]=(0,n.useState)(!0),c=(0,i.useRouter)();(0,n.useEffect)(()=>{d()},[]);let d=async()=>{try{let e=localStorage.getItem("token");if(e){let e=await o.O.getCurrentUser();r(e)}}catch(e){localStorage.removeItem("token")}finally{l(!1)}},h=async e=>{try{let t=await o.O.login(e);localStorage.setItem("token",t.access),localStorage.setItem("refresh",t.refresh),r(t.user)}catch(r){let e=r?.response?.data,t=e?.message||Array.isArray(e?.non_field_errors)&&e.non_field_errors[0]||e?.detail||"Erreur de connexion";throw Error(t)}},u=async()=>{try{await o.O.logout()}catch(e){console.error("Erreur lors de la d\xe9connexion:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("refresh"),r(null),c.push("/login")}};return s.jsx(m.Provider,{value:{user:t,loading:a,login:h,logout:u,updateUser:e=>{t&&r({...t,...e})}},children:e})}function d(){let e=(0,n.useContext)(m);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}a()}catch(e){a(e)}})},5913:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>c});var s=r(997),n=r(1175),i=r(6201),o=r(7179);r(6764);var l=e([i,o]);[i,o]=l.then?(await l)():l;let d=new n.QueryClient({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function c({Component:e,pageProps:t}){return s.jsx(n.QueryClientProvider,{client:d,children:s.jsx(o.H,{children:(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[s.jsx(e,{...t}),s.jsx(i.Toaster,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#22c55e",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})})}a()}catch(e){a(e)}})},1207:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Document});var a=r(997),s=r(6859);function Document(){return(0,a.jsxs)(s.Html,{lang:"fr",children:[(0,a.jsxs)(s.Head,{children:[a.jsx("meta",{charSet:"utf-8"}),a.jsx("meta",{name:"description",content:"Plateforme multicanal de feedback communautaire"}),a.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),a.jsx("link",{rel:"icon",href:"/favicon.ico"}),a.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),a.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"})]}),(0,a.jsxs)("body",{children:[a.jsx(s.Main,{}),a.jsx(s.NextScript,{})]})]})}},5843:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{E:()=>l});var s=r(9648),n=e([s]);s=(n.then?(await n)():n)[0];let i="http://localhost:8000/api/v1";class o{constructor(){this.api=s.default.create({baseURL:i,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=e.url||"",r=t;try{let e=new URL(t,i);r=e.pathname}catch(e){}let a=["/auth/login/","/auth/token/refresh/","/tickets/","/categories/","/priorities/","/statuses/","/channels/","/users/","/responses/","/logs/"].some(e=>r.endsWith(e)||r.includes(e));if(!a){let t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`)}return e},e=>Promise.reject(e)),this.api.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)))}async get(e,t){let r=await this.api.get(e,t);return r.data}async post(e,t,r){let a=await this.api.post(e,t,r);return a.data}async put(e,t,r){let a=await this.api.put(e,t,r);return a.data}async patch(e,t,r){let a=await this.api.patch(e,t,r);return a.data}async delete(e,t){let r=await this.api.delete(e,t);return r.data}async upload(e,t,r){let a=new FormData;a.append("file",t);let s=await this.api.post(e,a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{if(r&&e.total){let t=Math.round(100*e.loaded/e.total);r(t)}}});return s.data}}let l=new o;a()}catch(e){a(e)}})},4030:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.d(t,{O:()=>i});var s=r(5843),n=e([s]);s=(n.then?(await n)():n)[0];let i={login:async e=>s.E.post("/auth/login/",e),logout:async()=>s.E.post("/auth/logout/"),getCurrentUser:async()=>s.E.get("/auth/me/"),async refreshToken(){let e=localStorage.getItem("refresh");if(!e)throw Error("No refresh token available");return s.E.post("/auth/token/refresh/",{refresh:e})},changePassword:async e=>s.E.post("/users/users/change_password/",e),updateProfile:async e=>s.E.patch("/users/users/me/",e)};a()}catch(e){a(e)}})},6764:()=>{}};