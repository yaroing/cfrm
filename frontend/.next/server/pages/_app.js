(()=>{var e={};e.id=888,e.ids=[888],e.modules={7179:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{H:()=>u,a:()=>l});var a=r(997),o=r(6689),i=r(1163),n=r(4030),c=e([n]);n=(c.then?(await c)():c)[0];let h=(0,o.createContext)(void 0);function u({children:e}){let[t,r]=(0,o.useState)(null),[s,c]=(0,o.useState)(!0),u=(0,i.useRouter)();(0,o.useEffect)(()=>{l()},[]);let l=async()=>{try{let e=localStorage.getItem("token");if(e){let e=await n.O.getCurrentUser();r(e)}}catch(e){localStorage.removeItem("token")}finally{c(!1)}},p=async e=>{try{let t=await n.O.login(e);localStorage.setItem("token",t.access),localStorage.setItem("refresh",t.refresh),r(t.user)}catch(r){let e=r?.response?.data,t=e?.message||Array.isArray(e?.non_field_errors)&&e.non_field_errors[0]||e?.detail||"Erreur de connexion";throw Error(t)}},d=async()=>{try{await n.O.logout()}catch(e){console.error("Erreur lors de la d\xe9connexion:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("refresh"),r(null),u.push("/login")}};return a.jsx(h.Provider,{value:{user:t,loading:s,login:p,logout:d,updateUser:e=>{t&&r({...t,...e})}},children:e})}function l(){let e=(0,o.useContext)(h);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}s()}catch(e){s(e)}})},5913:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>u});var a=r(997),o=r(1175),i=r(6201),n=r(7179);r(6764);var c=e([i,n]);[i,n]=c.then?(await c)():c;let l=new o.QueryClient({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});function u({Component:e,pageProps:t}){return a.jsx(o.QueryClientProvider,{client:l,children:a.jsx(n.H,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(e,{...t}),a.jsx(i.Toaster,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#22c55e",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})})}s()}catch(e){s(e)}})},5843:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{E:()=>c});var a=r(9648),o=e([a]);a=(o.then?(await o)():o)[0];let i="http://localhost:8000/api/v1";class n{constructor(){this.api=a.default.create({baseURL:i,timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{let t=e.url||"",r=t;try{let e=new URL(t,i);r=e.pathname}catch(e){}let s=["/auth/login/","/auth/token/refresh/","/tickets/","/categories/","/priorities/","/statuses/","/channels/","/users/","/responses/","/logs/"].some(e=>r.endsWith(e)||r.includes(e));if(!s){let t=localStorage.getItem("token");t&&(e.headers.Authorization=`Bearer ${t}`)}return e},e=>Promise.reject(e)),this.api.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)))}async get(e,t){let r=await this.api.get(e,t);return r.data}async post(e,t,r){let s=await this.api.post(e,t,r);return s.data}async put(e,t,r){let s=await this.api.put(e,t,r);return s.data}async patch(e,t,r){let s=await this.api.patch(e,t,r);return s.data}async delete(e,t){let r=await this.api.delete(e,t);return r.data}async upload(e,t,r){let s=new FormData;s.append("file",t);let a=await this.api.post(e,s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{if(r&&e.total){let t=Math.round(100*e.loaded/e.total);r(t)}}});return a.data}}let c=new n;s()}catch(e){s(e)}})},4030:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{O:()=>i});var a=r(5843),o=e([a]);a=(o.then?(await o)():o)[0];let i={login:async e=>a.E.post("/auth/login/",e),logout:async()=>a.E.post("/auth/logout/"),getCurrentUser:async()=>a.E.get("/auth/me/"),async refreshToken(){let e=localStorage.getItem("refresh");if(!e)throw Error("No refresh token available");return a.E.post("/auth/token/refresh/",{refresh:e})},changePassword:async e=>a.E.post("/users/users/change_password/",e),updateProfile:async e=>a.E.patch("/users/users/me/",e)};s()}catch(e){s(e)}})},6764:()=>{},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},1175:e=>{"use strict";e.exports=require("react-query")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},9648:e=>{"use strict";e.exports=import("axios")},6201:e=>{"use strict";e.exports=import("react-hot-toast")},7147:e=>{"use strict";e.exports=require("fs")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[428,163],()=>r(5913));module.exports=s})();