(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{4813:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/analytics",function(){return a(9631)}])},9631:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return n}});var l=a(5893),t=a(7294),d=a(1255),i=a(214);function n(){var e,s;let[a,n]=(0,t.useState)([]),[r,c]=(0,t.useState)(null),[x,m]=(0,t.useState)(!0),[o,h]=(0,t.useState)(null),[u,j]=(0,t.useState)("7d");(0,t.useEffect)(()=>{g()},[u]);let g=async()=>{try{m(!0);let[e,s]=await Promise.all([d.E.get("/tickets/"),d.E.get("/tickets/dashboard_stats/")]);n(e.results||e),c(s)}catch(e){h("Erreur lors du chargement des donn\xe9es"),console.error("Erreur:",e)}finally{m(!1)}},v=e=>({Ouvert:"bg-blue-500","En cours":"bg-yellow-500",Fermé:"bg-green-500",Escaladé:"bg-red-500",Annulé:"bg-gray-500"})[e]||"bg-gray-400";return x?(0,l.jsx)(i.Z,{children:(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})})}):o?(0,l.jsx)(i.Z,{children:(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,l.jsxs)("div",{className:"ml-3",children:[(0,l.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Erreur"}),(0,l.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,l.jsx)("p",{children:o})})]})]})})}):(0,l.jsx)(i.Z,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Analytics"}),(0,l.jsx)("div",{className:"flex space-x-2",children:(0,l.jsxs)("select",{value:u,onChange:e=>j(e.target.value),className:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[(0,l.jsx)("option",{value:"7d",children:"7 derniers jours"}),(0,l.jsx)("option",{value:"30d",children:"30 derniers jours"}),(0,l.jsx)("option",{value:"90d",children:"90 derniers jours"}),(0,l.jsx)("option",{value:"1y",children:"1 an"})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Tickets ouverts"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:(null==r?void 0:null===(e=r.status_stats.find(e=>"Ouvert"===e.status__name))||void 0===e?void 0:e.count)||0})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Tickets ferm\xe9s"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:(null==r?void 0:null===(s=r.status_stats.find(e=>"Ferm\xe9"===e.status__name))||void 0===s?void 0:s.count)||0})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Tickets en retard"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:(null==r?void 0:r.overdue_count)||0})]})})]})})}),(0,l.jsx)("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:(0,l.jsx)("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center",children:(0,l.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,l.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,l.jsxs)("dl",{children:[(0,l.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Cette semaine"}),(0,l.jsx)("dd",{className:"text-lg font-medium text-gray-900",children:(null==r?void 0:r.weekly_tickets)||0})]})})]})})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tickets par statut"}),(0,l.jsx)("div",{className:"space-y-3",children:null==r?void 0:r.status_stats.map(e=>(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-4 h-4",children:(0,l.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(v(e.status__name))})}),(0,l.jsxs)("div",{className:"ml-3 flex-1",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-900",children:e.status__name}),(0,l.jsx)("span",{className:"text-gray-500",children:e.count})]}),(0,l.jsx)("div",{className:"mt-1 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"h-2 rounded-full ".concat(v(e.status__name)),style:{width:"".concat(e.count/Math.max(...(null==r?void 0:r.status_stats.map(e=>e.count))||[1])*100,"%")}})})]})]},e.status__name))})]}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tickets par cat\xe9gorie"}),(0,l.jsx)("div",{className:"space-y-3",children:null==r?void 0:r.category_stats.map(e=>(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-4 h-4",children:(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-indigo-500"})}),(0,l.jsxs)("div",{className:"ml-3 flex-1",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-900",children:e.category__name}),(0,l.jsx)("span",{className:"text-gray-500",children:e.count})]}),(0,l.jsx)("div",{className:"mt-1 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"h-2 rounded-full bg-indigo-500",style:{width:"".concat(e.count/Math.max(...(null==r?void 0:r.category_stats.map(e=>e.count))||[1])*100,"%")}})})]})]},e.category__name))})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tickets par canal"}),(0,l.jsx)("div",{className:"space-y-3",children:null==r?void 0:r.channel_stats.map(e=>(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-4 h-4",children:(0,l.jsx)("div",{className:"w-4 h-4 rounded-full bg-green-500"})}),(0,l.jsxs)("div",{className:"ml-3 flex-1",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{className:"text-gray-900",children:e.channel__name}),(0,l.jsx)("span",{className:"text-gray-500",children:e.count})]}),(0,l.jsx)("div",{className:"mt-1 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"h-2 rounded-full bg-green-500",style:{width:"".concat(e.count/Math.max(...(null==r?void 0:r.channel_stats.map(e=>e.count))||[1])*100,"%")}})})]})]},e.channel__name))})]}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Tickets r\xe9cents"}),(0,l.jsx)("a",{href:"/tickets",className:"text-sm text-indigo-600 hover:text-indigo-500",children:"Voir tout"})]}),(0,l.jsx)("div",{className:"space-y-3",children:a.slice(0,5).map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["#",e.id.slice(0,8)]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(v(e.status_name)," text-white"),children:e.status_name}),(0,l.jsx)("span",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]},e.id))})]})]}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Tendance des tickets"}),(0,l.jsx)("div",{className:"h-64 flex items-center justify-center bg-gray-50 rounded-lg",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,l.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Graphique de tendance \xe0 venir..."})]})})]})]})})}}},function(e){e.O(0,[430,117,214,774,888,179],function(){return e(e.s=4813)}),_N_E=e.O()}]);